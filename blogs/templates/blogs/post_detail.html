{% extends 'blogs/base.html' %}
{% load bootstrap4 %}


{% block page_header %}
<h2> {{ posts.title }} </h2>
<p class="details"> published by <a href="{{ posts.author.get_absolute_url }}"> {{ posts.author.first_name|title }} {{ posts.author.last_name|title }} </a> <br> {{ posts.date_added.date }} </p>
{% endblock page_header %}


{% block content %}
<div class="main mb-5">
    <p> {{ posts.text }} </p>
    <div class="textlink mt-5" >
        {% if posts.source %}
        <span> Source: <a href="{{ posts.source }}"> {{ posts.source }} </a> </span>
        {% endif %}
    </div> 
</div>

<div class="p-5 border-bottom ">
    {% if request.user.is_superuser or request.user == posts.author.user %}
        <a class="btn btn-primary p-1" style="color:white;" href="{% url 'blogs:edit_post' posts.slug posts.pk %}"> Edit post</a> 
        <a class="btn btn-danger ml-5 p-1" style="color:white;" href="{% url 'blogs:delete_post' posts.slug posts.pk %}"> Delete post </a>
    {% endif %}
</div>

<div class="mt-3" id="comment-section">
    <h4 style="display: inline-block;">{% if posts.comment_set.all %} Comments </h4>
    <i style="color: burlywood;"> {{ comment_count.count }} comments </i>  
    {% for comment in posts.comment_set.all %}
        <div class="ml-5">
            <p> <b> {{ comment.username }}: </b> - <i style="color:rgb(187, 187, 187);"> {{ comment.date_created|timesince }} ago </i> <br> 
            {{ comment.text }} </p>  
        </div> 
    {% endfor %}  
    {% else %} 
        No comments..
    {% endif %}   
</div>

<hr>
<h4> Add a comment </h4>
<form action="" method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <input type="submit" class="btn bg-dark text-white p-1 mt-5" value="Post comment"/>
</form>
{% endblock %}
